<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>B Programming in R | Learning statistics with R</title>
  <meta name="description" content="A gentle introduction to statistics and R using the tidyverse" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="B Programming in R | Learning statistics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://djnavarro.github.io/tidylsrbook" />
  
  <meta property="og:description" content="A gentle introduction to statistics and R using the tidyverse" />
  <meta name="github-repo" content="djnavarro/tidylsrbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="B Programming in R | Learning statistics with R" />
  
  <meta name="twitter:description" content="A gentle introduction to statistics and R using the tidyverse" />
  

<meta name="author" content="Danielle Navarro" />


<meta name="date" content="2019-06-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-types.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="https://fonts.googleapis.com/css?family=Crimson+Text|Heebo&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style_new.css" type="text/css" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#whywhywhy"><i class="fa fa-check"></i><b>1.1</b> Why statistics?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#the-curse-of-belief-bias"><i class="fa fa-check"></i><b>1.1.1</b> The curse of belief bias</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#statistics-in-psychology"><i class="fa fa-check"></i><b>1.1.2</b> Statistics in psychology</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#statistics-in-everyday-life"><i class="fa fa-check"></i><b>1.1.3</b> Statistics in everyday life</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro.html"><a href="intro.html#on-the-limitations-of-statistics"><i class="fa fa-check"></i><b>1.1.4</b> On the limitations of statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-learn-r"><i class="fa fa-check"></i><b>1.2</b> Why learn R?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#first-steps"><i class="fa fa-check"></i><b>1.3</b> First steps</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#installing-r-rstudio"><i class="fa fa-check"></i><b>1.3.1</b> Installing R &amp; RStudio</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#r-commands"><i class="fa fa-check"></i><b>1.3.2</b> R commands</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#avoid-typos"><i class="fa fa-check"></i><b>1.3.3</b> Avoid typos</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#r-is-flexible-with-spacing"><i class="fa fa-check"></i><b>1.3.4</b> R is flexible with spacing?</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#r-knows-youre-not-finished"><i class="fa fa-check"></i><b>1.3.5</b> R knows you‚Äôre not finished?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#operations"><i class="fa fa-check"></i><b>1.4</b> Operations</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#arithmetic-operations"><i class="fa fa-check"></i><b>1.4.1</b> Arithmetic operations</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#order-of-operations"><i class="fa fa-check"></i><b>1.4.2</b> Order of operations</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#functions"><i class="fa fa-check"></i><b>1.5</b> Functions</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#using-functions"><i class="fa fa-check"></i><b>1.5.1</b> Using functions</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#combining-functions"><i class="fa fa-check"></i><b>1.5.2</b> Combining functions</a></li>
<li class="chapter" data-level="1.5.3" data-path="intro.html"><a href="intro.html#multiple-arguments"><i class="fa fa-check"></i><b>1.5.3</b> Multiple arguments</a></li>
<li class="chapter" data-level="1.5.4" data-path="intro.html"><a href="intro.html#argument-names"><i class="fa fa-check"></i><b>1.5.4</b> Argument names</a></li>
<li class="chapter" data-level="1.5.5" data-path="intro.html"><a href="intro.html#default-values"><i class="fa fa-check"></i><b>1.5.5</b> Default values</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#rstudio-helps"><i class="fa fa-check"></i><b>1.6</b> RStudio helps!</a><ul>
<li class="chapter" data-level="1.6.1" data-path="intro.html"><a href="intro.html#tab-autocomplete"><i class="fa fa-check"></i><b>1.6.1</b> Tab autocomplete</a></li>
<li class="chapter" data-level="1.6.2" data-path="intro.html"><a href="intro.html#the-history-pane"><i class="fa fa-check"></i><b>1.6.2</b> The history pane</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.7</b> Exercises</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#project-oriented-workflow"><i class="fa fa-check"></i><b>1.8</b> Project oriented workflow</a></li>
</ul></li>
<li class="part"><span><b>II Exploring data</b></span></li>
<li class="chapter" data-level="2" data-path="datavis.html"><a href="datavis.html"><i class="fa fa-check"></i><b>2</b> Pretty pictures</a><ul>
<li class="chapter" data-level="2.1" data-path="datavis.html"><a href="datavis.html#r-graphics"><i class="fa fa-check"></i><b>2.1</b> R graphics</a></li>
<li class="chapter" data-level="2.2" data-path="datavis.html"><a href="datavis.html#the-data-set"><i class="fa fa-check"></i><b>2.2</b> The data set</a></li>
<li class="chapter" data-level="2.3" data-path="datavis.html"><a href="datavis.html#histograms"><i class="fa fa-check"></i><b>2.3</b> Histograms</a></li>
<li class="chapter" data-level="2.4" data-path="datavis.html"><a href="datavis.html#scatter-plot"><i class="fa fa-check"></i><b>2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5" data-path="datavis.html"><a href="datavis.html#bar-graphs"><i class="fa fa-check"></i><b>2.5</b> Bar graphs</a></li>
<li class="chapter" data-level="2.6" data-path="datavis.html"><a href="datavis.html#box-plots"><i class="fa fa-check"></i><b>2.6</b> Box plots</a></li>
<li class="chapter" data-level="2.7" data-path="datavis.html"><a href="datavis.html#violin-plots"><i class="fa fa-check"></i><b>2.7</b> Violin plots</a></li>
<li class="chapter" data-level="2.8" data-path="datavis.html"><a href="datavis.html#facetted-plots"><i class="fa fa-check"></i><b>2.8</b> Facetted plots</a></li>
<li class="chapter" data-level="2.9" data-path="datavis.html"><a href="datavis.html#bubble-plots"><i class="fa fa-check"></i><b>2.9</b> Bubble plots</a></li>
<li class="chapter" data-level="2.10" data-path="datavis.html"><a href="datavis.html#error-bars"><i class="fa fa-check"></i><b>2.10</b> Error bars</a></li>
<li class="chapter" data-level="2.11" data-path="datavis.html"><a href="datavis.html#other-possibilities"><i class="fa fa-check"></i><b>2.11</b> Other possibilities</a></li>
<li class="chapter" data-level="2.12" data-path="datavis.html"><a href="datavis.html#saving-images"><i class="fa fa-check"></i><b>2.12</b> Saving images</a></li>
<li class="chapter" data-level="2.13" data-path="datavis.html"><a href="datavis.html#further-reading"><i class="fa fa-check"></i><b>2.13</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>III Learning from data</b></span></li>
<li class="part"><span><b>IV Tools of the trade</b></span></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>A</b> Data types in R</a><ul>
<li class="chapter" data-level="A.1" data-path="data-types.html"><a href="data-types.html#vectors"><i class="fa fa-check"></i><b>A.1</b> Vectors</a><ul>
<li class="chapter" data-level="A.1.1" data-path="data-types.html"><a href="data-types.html#character-vectors"><i class="fa fa-check"></i><b>A.1.1</b> Character vectors</a></li>
<li class="chapter" data-level="A.1.2" data-path="data-types.html"><a href="data-types.html#numeric-vectors"><i class="fa fa-check"></i><b>A.1.2</b> Numeric vectors</a></li>
<li class="chapter" data-level="A.1.3" data-path="data-types.html"><a href="data-types.html#extracting-an-element"><i class="fa fa-check"></i><b>A.1.3</b> Extracting an element</a></li>
<li class="chapter" data-level="A.1.4" data-path="data-types.html"><a href="data-types.html#extracting-multiple-elements"><i class="fa fa-check"></i><b>A.1.4</b> Extracting multiple elements</a></li>
<li class="chapter" data-level="A.1.5" data-path="data-types.html"><a href="data-types.html#removing-elements"><i class="fa fa-check"></i><b>A.1.5</b> Removing elements</a></li>
<li class="chapter" data-level="A.1.6" data-path="data-types.html"><a href="data-types.html#editing-vectors"><i class="fa fa-check"></i><b>A.1.6</b> Editing vectors</a></li>
<li class="chapter" data-level="A.1.7" data-path="data-types.html"><a href="data-types.html#naming-elements"><i class="fa fa-check"></i><b>A.1.7</b> Naming elements</a></li>
<li class="chapter" data-level="A.1.8" data-path="data-types.html"><a href="data-types.html#vector-operations"><i class="fa fa-check"></i><b>A.1.8</b> Vector operations</a></li>
<li class="chapter" data-level="A.1.9" data-path="data-types.html"><a href="data-types.html#logical-vectors"><i class="fa fa-check"></i><b>A.1.9</b> Logical vectors</a></li>
<li class="chapter" data-level="A.1.10" data-path="data-types.html"><a href="data-types.html#comment"><i class="fa fa-check"></i><b>A.1.10</b> Comment</a></li>
<li class="chapter" data-level="A.1.11" data-path="data-types.html"><a href="data-types.html#exercises-1"><i class="fa fa-check"></i><b>A.1.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="data-types.html"><a href="data-types.html#factors"><i class="fa fa-check"></i><b>A.2</b> Factors</a><ul>
<li class="chapter" data-level="A.2.1" data-path="data-types.html"><a href="data-types.html#unordered-factors"><i class="fa fa-check"></i><b>A.2.1</b> Unordered factors</a></li>
<li class="chapter" data-level="A.2.2" data-path="data-types.html"><a href="data-types.html#ordered-factors"><i class="fa fa-check"></i><b>A.2.2</b> Ordered factors</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="data-types.html"><a href="data-types.html#data-frames-tibbles"><i class="fa fa-check"></i><b>A.3</b> Data frames / tibbles</a><ul>
<li class="chapter" data-level="A.3.1" data-path="data-types.html"><a href="data-types.html#making-a-data-frame"><i class="fa fa-check"></i><b>A.3.1</b> Making a data frame</a></li>
<li class="chapter" data-level="A.3.2" data-path="data-types.html"><a href="data-types.html#making-a-tibble"><i class="fa fa-check"></i><b>A.3.2</b> Making a tibble</a></li>
<li class="chapter" data-level="A.3.3" data-path="data-types.html"><a href="data-types.html#tibbles-are-data-frames"><i class="fa fa-check"></i><b>A.3.3</b> Tibbles are data frames</a></li>
<li class="chapter" data-level="A.3.4" data-path="data-types.html"><a href="data-types.html#using-the-operator"><i class="fa fa-check"></i><b>A.3.4</b> Using the <code>$</code> operator</a></li>
<li class="chapter" data-level="A.3.5" data-path="data-types.html"><a href="data-types.html#using-square-brackets"><i class="fa fa-check"></i><b>A.3.5</b> Using square brackets</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="data-types.html"><a href="data-types.html#matrices"><i class="fa fa-check"></i><b>A.4</b> Matrices</a><ul>
<li class="chapter" data-level="A.4.1" data-path="data-types.html"><a href="data-types.html#matrix-indexing"><i class="fa fa-check"></i><b>A.4.1</b> Matrix indexing</a></li>
<li class="chapter" data-level="A.4.2" data-path="data-types.html"><a href="data-types.html#matrices-vs-data-frames"><i class="fa fa-check"></i><b>A.4.2</b> Matrices vs data frames</a></li>
<li class="chapter" data-level="A.4.3" data-path="data-types.html"><a href="data-types.html#other-ways-to-make-a-matrix"><i class="fa fa-check"></i><b>A.4.3</b> Other ways to make a matrix</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="data-types.html"><a href="data-types.html#arrays"><i class="fa fa-check"></i><b>A.5</b> Arrays</a><ul>
<li class="chapter" data-level="A.5.1" data-path="data-types.html"><a href="data-types.html#array-indexing"><i class="fa fa-check"></i><b>A.5.1</b> Array indexing</a></li>
<li class="chapter" data-level="A.5.2" data-path="data-types.html"><a href="data-types.html#array-names"><i class="fa fa-check"></i><b>A.5.2</b> Array names</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="data-types.html"><a href="data-types.html#lists"><i class="fa fa-check"></i><b>A.6</b> Lists</a><ul>
<li class="chapter" data-level="A.6.1" data-path="data-types.html"><a href="data-types.html#indexing-lists"><i class="fa fa-check"></i><b>A.6.1</b> Indexing lists</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="data-types.html"><a href="data-types.html#dates"><i class="fa fa-check"></i><b>A.7</b> Dates</a></li>
<li class="chapter" data-level="A.8" data-path="data-types.html"><a href="data-types.html#coercion"><i class="fa fa-check"></i><b>A.8</b> Coercion</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>B</b> Programming in R</a><ul>
<li class="chapter" data-level="B.1" data-path="programming.html"><a href="programming.html#ifelse"><i class="fa fa-check"></i><b>B.1</b> If/else</a><ul>
<li class="chapter" data-level="B.1.1" data-path="programming.html"><a href="programming.html#example-1"><i class="fa fa-check"></i><b>B.1.1</b> Example 1:</a></li>
<li class="chapter" data-level="B.1.2" data-path="programming.html"><a href="programming.html#example-2"><i class="fa fa-check"></i><b>B.1.2</b> Example 2:</a></li>
<li class="chapter" data-level="B.1.3" data-path="programming.html"><a href="programming.html#exercises-2"><i class="fa fa-check"></i><b>B.1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="programming.html"><a href="programming.html#loops"><i class="fa fa-check"></i><b>B.2</b> Loops</a><ul>
<li class="chapter" data-level="B.2.1" data-path="programming.html"><a href="programming.html#the-while-loop"><i class="fa fa-check"></i><b>B.2.1</b> The <code>while</code> loop</a></li>
<li class="chapter" data-level="B.2.2" data-path="programming.html"><a href="programming.html#a-simple-example"><i class="fa fa-check"></i><b>B.2.2</b> A simple example</a></li>
<li class="chapter" data-level="B.2.3" data-path="programming.html"><a href="programming.html#mortgage-calculator"><i class="fa fa-check"></i><b>B.2.3</b> Mortgage calculator</a></li>
<li class="chapter" data-level="B.2.4" data-path="programming.html"><a href="programming.html#the-for-loop"><i class="fa fa-check"></i><b>B.2.4</b> The <code>for</code> loop</a></li>
<li class="chapter" data-level="B.2.5" data-path="programming.html"><a href="programming.html#multiplication-tables"><i class="fa fa-check"></i><b>B.2.5</b> Multiplication tables</a></li>
<li class="chapter" data-level="B.2.6" data-path="programming.html"><a href="programming.html#looping-over-other-vectors"><i class="fa fa-check"></i><b>B.2.6</b> Looping over other vectors</a></li>
<li class="chapter" data-level="B.2.7" data-path="programming.html"><a href="programming.html#vectorised-code"><i class="fa fa-check"></i><b>B.2.7</b> Vectorised code?</a></li>
<li class="chapter" data-level="B.2.8" data-path="programming.html"><a href="programming.html#exercises-3"><i class="fa fa-check"></i><b>B.2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="programming.html"><a href="programming.html#functions-1"><i class="fa fa-check"></i><b>B.3</b> Functions</a><ul>
<li class="chapter" data-level="B.3.1" data-path="programming.html"><a href="programming.html#a-boring-example"><i class="fa fa-check"></i><b>B.3.1</b> A boring example</a></li>
<li class="chapter" data-level="B.3.2" data-path="programming.html"><a href="programming.html#default-arguments"><i class="fa fa-check"></i><b>B.3.2</b> Default arguments</a></li>
<li class="chapter" data-level="B.3.3" data-path="programming.html"><a href="programming.html#unspecified-arguments"><i class="fa fa-check"></i><b>B.3.3</b> Unspecified arguments</a></li>
<li class="chapter" data-level="B.3.4" data-path="programming.html"><a href="programming.html#more-on-functions"><i class="fa fa-check"></i><b>B.3.4</b> More on functions?</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="programming.html"><a href="programming.html#rescorla-wagner-model"><i class="fa fa-check"></i><b>B.4</b> Rescorla-Wagner model</a><ul>
<li class="chapter" data-level="B.4.1" data-path="programming.html"><a href="programming.html#the-model-itself"><i class="fa fa-check"></i><b>B.4.1</b> The model itself</a></li>
<li class="chapter" data-level="B.4.2" data-path="programming.html"><a href="programming.html#r-implementation"><i class="fa fa-check"></i><b>B.4.2</b> R implementation</a></li>
<li class="chapter" data-level="B.4.3" data-path="programming.html"><a href="programming.html#the-skeleton"><i class="fa fa-check"></i><b>B.4.3</b> The skeleton</a></li>
<li class="chapter" data-level="B.4.4" data-path="programming.html"><a href="programming.html#make-a-plan"><i class="fa fa-check"></i><b>B.4.4</b> Make a plan</a></li>
<li class="chapter" data-level="B.4.5" data-path="programming.html"><a href="programming.html#fill-in-the-pieces"><i class="fa fa-check"></i><b>B.4.5</b> Fill in the pieces</a></li>
<li class="chapter" data-level="B.4.6" data-path="programming.html"><a href="programming.html#tidying"><i class="fa fa-check"></i><b>B.4.6</b> Tidying</a></li>
<li class="chapter" data-level="B.4.7" data-path="programming.html"><a href="programming.html#model-predictions"><i class="fa fa-check"></i><b>B.4.7</b> Model predictions</a></li>
<li class="chapter" data-level="B.4.8" data-path="programming.html"><a href="programming.html#conditioning"><i class="fa fa-check"></i><b>B.4.8</b> Conditioning</a></li>
<li class="chapter" data-level="B.4.9" data-path="programming.html"><a href="programming.html#extinction"><i class="fa fa-check"></i><b>B.4.9</b> Extinction</a></li>
<li class="chapter" data-level="B.4.10" data-path="programming.html"><a href="programming.html#blocking"><i class="fa fa-check"></i><b>B.4.10</b> Blocking</a></li>
<li class="chapter" data-level="B.4.11" data-path="programming.html"><a href="programming.html#done"><i class="fa fa-check"></i><b>B.4.11</b> Done!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programming" class="section level1">
<h1><span class="header-section-number">B</span> Programming in R</h1>
<p>When I introduced the idea of working with scripts I said that R starts at the top of the file and runs straight through to the end of the file. That was a tiny bit of a lie. It is true that unless you insert commands to explicitly alter how the script runs, that is what will happen. However, you actually have quite a lot of flexibility in this respect. Depending on how you write the script, you can have R repeat several commands, or skip over different commands, and so on. This topic is referred to as <strong>flow control</strong>.</p>
<div id="ifelse" class="section level2">
<h2><span class="header-section-number">B.1</span> If/else</h2>
<p>One kind of flow control that programming languages provide is the ability to evaluate <strong>conditional statements</strong>. Unlike loops, which can repeat over and over again, a conditional statement only executes once, but it can switch between different possible commands depending on a condition that is specified by the programmer. The power of these commands is that they allow the program itself to make choices, and in particular, to make different choices depending on the context in which the program is run. The most prominent of example of a conditional statement is the <code>if</code> statement, and the accompanying <code>else</code> statement.<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a></p>
<p>The basic format of an <code>if</code> statement in R is as follows:</p>
<pre><code>if ( CONDITION ) {
  STATEMENT1
  STATEMENT2
  ETC 
}</code></pre>
<p>And the execution of the statement is pretty straightforward. If the condition is <code>TRUE</code>, then R will execute the statements contained in the curly braces. If the condition is <code>FALSE</code>, then it does not. So the way R processes an <code>if</code> statement is illustrated by this schematic:</p>
<p><img src="img/branch_if.png" width=500px></p>
<p>If you want to, you can extend the <code>if</code> statement to include an <code>else</code> statement as well, leading to the following syntax:</p>
<pre><code>if ( CONDITION ) {
  STATEMENT1
  STATEMENT2
  ETC
} else {
  STATEMENT3
  STATEMENT4
  ETC
}</code></pre>
<p>As you‚Äôd expect, the interpretation of this version is similar. If the condition is <code>TRUE</code>, then the contents of the first block of code (i.e., <em>statement1</em>, <em>statement2</em>, etc) are executed; but if it is <code>FALSE</code>, then the contents of the second block of code (i.e., <em>statement3</em>, <em>statement4</em>, etc) are executed instead. So the schematic illustration of an if-else construction looks like this:</p>
<p><img src="img/branch_ifelse.png" width=550px></p>
<p>In other words, when we use an if-else pair, we can define different behaviour for our script for both cases.</p>
<div id="example-1" class="section level3">
<h3><span class="header-section-number">B.1.1</span> Example 1:</h3>
<p>To give you a feel for how you can use <code>if</code> and <code>else</code>, the example that I‚Äôll show you is a script (<a href="./scripts/feelings.R">feelings.R</a>) that prints out a different message depending the day of the week. Here‚Äôs the script:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(today <span class="op">==</span><span class="st"> &quot;Monday&quot;</span>) {
  <span class="kw">print</span>(<span class="st">&quot;I don‚Äôt like Mondays&quot;</span>)
} <span class="cf">else</span> {
  <span class="kw">print</span>(<span class="st">&quot;I‚Äôm a happy little automaton&quot;</span>)
}</code></pre>
<p>So let‚Äôs set the value of <code>today</code> to <code>Monday</code> and source the script:</p>
<pre class="sourceCode r"><code class="sourceCode r">today &lt;-<span class="st"> &quot;Monday&quot;</span>
<span class="kw">source</span>(<span class="st">&quot;./scripts/feelings.R&quot;</span>)</code></pre>
<pre><code>## [1] &quot;I don‚Äôt like Mondays&quot;</code></pre>
<p>That‚Äôs very sad. However, tomorrow should be better:</p>
<pre class="sourceCode r"><code class="sourceCode r">today &lt;-<span class="st"> &quot;Tuesday&quot;</span>
<span class="kw">source</span>(<span class="st">&quot;./scripts/feelings.R&quot;</span>)</code></pre>
<pre><code>## [1] &quot;I‚Äôm a happy little automaton&quot;</code></pre>
</div>
<div id="example-2" class="section level3">
<h3><span class="header-section-number">B.1.2</span> Example 2:</h3>
<p>One useful feature of <code>if</code> and <code>else</code> is that you can chain several of them together to switch between several different possibilities. For example, the <a href="./scripts/more_feelings.R">more_feelings.R</a> script contains this code:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(today <span class="op">==</span><span class="st"> &quot;Monday&quot;</span>) {
  <span class="kw">print</span>(<span class="st">&quot;I don‚Äôt like Mondays&quot;</span>)
  
} <span class="cf">else</span> <span class="cf">if</span>(today <span class="op">==</span><span class="st"> &quot;Tuesday&quot;</span>) {
  <span class="kw">print</span>(<span class="st">&quot;I‚Äôm a happy little automaton&quot;</span>)
  
} <span class="cf">else</span> <span class="cf">if</span>(today <span class="op">==</span><span class="st"> &quot;Wednesday&quot;</span>) {
  <span class="kw">print</span>(<span class="st">&quot;Wednesday is beige&quot;</span>)
  
} <span class="cf">else</span> {
  <span class="kw">print</span>(<span class="st">&quot;eh, I have no feelings&quot;</span>)
}</code></pre>
</div>
<div id="exercises-2" class="section level3">
<h3><span class="header-section-number">B.1.3</span> Exercises</h3>
<ul>
<li>Write your own version of the ‚Äúfeelings‚Äù script that expresses your opinions about summer, winter, autumn and spring. Test your script out.</li>
<li>Expand your script so that it loops over vector of four <code>seasons</code> and prints out your feelings about each of them</li>
</ul>
<p>The solutions for these exercises are <a href="./scripts/solutions_branch.R">here</a>.</p>
</div>
</div>
<div id="loops" class="section level2">
<h2><span class="header-section-number">B.2</span> Loops</h2>
<p>The second kind of flow control that I want to talk about is a <strong>loop</strong>. The idea is simple: a loop is a block of code (i.e., a sequence of commands) that R will execute over and over again until some <em>termination criterion</em> is met. To illustrate the idea, here‚Äôs a schematic picture showing the difference between what R does with a script that contains a loop and one that doesn‚Äôt:</p>
<p><img src="img/loop_schematic.png" width="600px"></p>
<p>Looping is a very powerful idea, because it allows you to automate repetitive tasks. Much like my children, R will execute an continuous cycle of <em>‚Äúare we there yet? are we there yet? are we there yet?‚Äù</em> checks against the termination criterion, and it will keep going forever until it is finally <em>there</em> and can break out of the loop. Rather unlike my children, however, I find that this behaviour is actually helpful.</p>
<p>There are several different ways to construct a loop in R. There are two methods I‚Äôll talk about here, one using the <code>while</code> command and another using the <code>for</code> command.</p>
<div id="the-while-loop" class="section level3">
<h3><span class="header-section-number">B.2.1</span> The <code>while</code> loop</h3>
<p>A <code>while</code> loop is a simple thing. The basic format of the loop looks like this:</p>
<pre><code>while ( CONDITION ) {
  STATEMENT1
  STATEMENT2
  ETC 
}</code></pre>
<p>The code corresponding to <code>condition</code> needs to produce a logical value, either <code>TRUE</code> or <code>FALSE</code>. Whenever R encounters a while statement, it checks to see if the condition is <code>TRUE</code>. If it is, then R goes on to execute all of the commands inside the curly brackets, proceeding from top to bottom as usual. However, when it gets to the bottom of those statements, it moves back up to the while statement. Then, like the mindless automaton it is, it checks to see if the condition is <code>TRUE</code>. If it is, then R goes on to execute all the commands inside ‚Ä¶ well, you get the idea. This continues endlessly until at some point the <code>condition</code> turns out to be <code>FALSE</code>. Once that happens, R jumps to the bottom of the loop (i.e., to the <code>}</code> character), and then continues on with whatever commands appear next in the script.</p>
</div>
<div id="a-simple-example" class="section level3">
<h3><span class="header-section-number">B.2.2</span> A simple example</h3>
<p>To start with, let‚Äôs keep things simple, and use a <code>while</code> loop to calculate the smallest multiple of 179 that is greater than or equal to 1000. This is of course a very silly example, since you can calculate it using simple arithmetic, but the point here isn‚Äôt to do something novel. The point is to show how to write a <code>while</code> loop. Here‚Äôs the code in action:</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="cf">while</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) {
  x &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">179</span>
}
<span class="kw">print</span>(x)</code></pre>
<pre><code>## [1] 1074</code></pre>
<p>When we run this code, R starts at the top and creates a new variable called <code>x</code> and assigns it a value of 0. It then moves down to the loop, and ‚Äúnotices‚Äù that the condition here is <code>x &lt; 1000</code>. Since the current value of <code>x</code> is zero, the condition is <code>TRUE</code>, so it enters the body of the loop (inside the curly braces). There‚Äôs only one command here, which instructs R to increase the value of <code>x</code> by 179. R then returns to the top of the loop, and rechecks the condition. The value of <code>x</code> is now 179, but that‚Äôs still less than 1000, so the loop continues. Here‚Äôs a visual representation of that:</p>
<p><img src="img/loop_while1.png" width="300px"></p>
<p>To see this in action, we can move the <code>print</code> statement inside the body of the loop. By doing that, R will print out the value of <code>x</code> every time it gets updated. Let‚Äôs watch:</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="cf">while</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) {
  x &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">179</span>
  <span class="kw">print</span>(x)
}</code></pre>
<pre><code>## [1] 179
## [1] 358
## [1] 537
## [1] 716
## [1] 895
## [1] 1074</code></pre>
<p>Truly fascinating stuff. ü§î</p>
</div>
<div id="mortgage-calculator" class="section level3">
<h3><span class="header-section-number">B.2.3</span> Mortgage calculator</h3>
<p>To give you a sense of how you can use a <code>while</code> loop in a more complex situation, let‚Äôs write a simple script to simulate the progression of a mortgage. BLEGH COME UP WITH SOMETHING BETTER</p>
<p>A happy ending! üéâ üéà üç∞</p>
</div>
<div id="the-for-loop" class="section level3">
<h3><span class="header-section-number">B.2.4</span> The <code>for</code> loop</h3>
<p>The <code>for</code> loop is also pretty simple, though not quite as simple as the <code>while</code> loop. The basic format of this loop goes like this:</p>
<pre><code>for ( VAR in VECTOR ) {
  STATEMENT1
  STATEMENT2
  ETC 
}</code></pre>
<p>In a <code>for</code> loop, R runs a fixed number of iterations. We have a vector which has several elements, each one corresponding to a possible value of the variable <code>var</code>. In the first iteration of the loop, <code>var</code> is given a value corresponding to the first element of vector; in the second iteration of the loop <code>var</code> gets a value corresponding to the second value in vector; and so on. Once we‚Äôve exhausted all of the values in the vector, the loop terminates and the flow of the program continues down the script.</p>
</div>
<div id="multiplication-tables" class="section level3">
<h3><span class="header-section-number">B.2.5</span> Multiplication tables</h3>
<p>When I was a kid we used to have multiplication tables hanging on the walls at home, so I‚Äôd end up memorising the all the multiples of small numbers. I was okay at this as long as all the numbers were smaller than 10. Anything above that and I got lazy. So as a first example we‚Äôll get R to print out the multiples of 137. Let‚Äôs say I want to it to calculate <span class="math inline">\(137 \times 1\)</span>, then <span class="math inline">\(137 \times 2\)</span>, and so on until we reach <span class="math inline">\(137 \times 10\)</span>. In other words what we want to do is calculate <code>137 * value</code> for every <code>value</code> within the range spanned by <code>1:10</code>, and then print the answer to the console. Because we have a <em>fixed</em> range of values that we want to loop over, this situation is well-suited to a <code>for</code> loop. Here‚Äôs the code:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(value <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {
  answer &lt;-<span class="st"> </span><span class="dv">137</span> <span class="op">*</span><span class="st"> </span>value
  <span class="kw">print</span>(answer)
}</code></pre>
<pre><code>## [1] 137
## [1] 274
## [1] 411
## [1] 548
## [1] 685
## [1] 822
## [1] 959
## [1] 1096
## [1] 1233
## [1] 1370</code></pre>
<p>The intuition here is that R starts by setting <code>value</code> to 1. It then computes and prints <code>137 * value</code>, then moves back to the top of the loop. When it gets there, it increases <code>value</code> by 1, and then repeats the calculation. It keeps doing this until the <code>value</code> reaches 10 and then it stops. That intuition is essentially correct, but it‚Äôs worth unpacking it a bit further using a different example where R loops over something other than a sequence of numbers‚Ä¶</p>
</div>
<div id="looping-over-other-vectors" class="section level3">
<h3><span class="header-section-number">B.2.6</span> Looping over other vectors</h3>
<p>In the example above, the <code>for</code> loop was defined over the numbers from 1 to 10, specified using the R code <code>1:10</code>. However, it‚Äôs worth keeping in mind that as far as R is concerned, <code>1:10</code> is actually a vector:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<p>So in the previous example, the intuition about the <code>for</code> loop is slightly misleading. When R gets to the top of the loop the action it takes is ‚Äú<em>assigning</em> <code>value</code> <em>equal to the next element of the vector</em>‚Äù. In this case it turns out that this action causes R to ‚Äú<em>increase</em> <code>value</code> <em>by 1</em>‚Äù, but that‚Äôs not true in general. To illustrate that, here‚Äôs an example in which a <code>for</code> loop iterates over a character vector. First, I‚Äôll create a vector of <code>words</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">words &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;it&quot;</span>, <span class="st">&quot;was&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;dirty&quot;</span>, <span class="st">&quot;end&quot;</span>, <span class="st">&quot;of&quot;</span>, <span class="st">&quot;winter&quot;</span>)</code></pre>
<p>Now what I‚Äôll do is create a <code>for</code> loop using this vector. For every word in the vector of <code>words</code> R will do three things:</p>
<ul>
<li>Count the number of letters in the word</li>
<li>Convert the word to upper case</li>
<li>Print a nice summary to the console</li>
</ul>
<p>Here it is:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(this_word <span class="cf">in</span> words) {
  n_letters &lt;-<span class="st"> </span><span class="kw">nchar</span>(this_word)
  block_word &lt;-<span class="st"> </span><span class="kw">toupper</span>(this_word)
  <span class="kw">cat</span>(block_word, <span class="st">&quot;has&quot;</span>, n_letters, <span class="st">&quot;letters</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre>
<pre><code>## IT has 2 letters
## WAS has 3 letters
## THE has 3 letters
## DIRTY has 5 letters
## END has 3 letters
## OF has 2 letters
## WINTER has 6 letters</code></pre>
<p>From the perspective of the R interpreter this is what the code four the <code>for</code> loop is doing. It‚Äôs pretty similar to the <code>while</code> loop, but not quite the same:</p>
<p><img src="img/loop_for1.png" width="350px"></p>
</div>
<div id="vectorised-code" class="section level3">
<h3><span class="header-section-number">B.2.7</span> Vectorised code?</h3>
<blockquote>
<p>Somebody has to write loops: it doesn‚Äôt have to be you
- Jenny Bryan</p>
</blockquote>
<p>Of course, there are ways of doing this that don‚Äôt require you to write the loop manually. Because many functions in R operate naturally on vectors, you can take advantage of this. Code that bypasses the need to write loops is called <em>vectorised</em> code, and there are some good reasons to do this (sometimes) once you‚Äôre comfortable working in R. Here‚Äôs an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">chars &lt;-<span class="st"> </span><span class="kw">nchar</span>(words)
<span class="kw">names</span>(chars) &lt;-<span class="st"> </span><span class="kw">toupper</span>(words)
<span class="kw">print</span>(chars)</code></pre>
<pre><code>##     IT    WAS    THE  DIRTY    END     OF WINTER 
##      2      3      3      5      3      2      6</code></pre>
<p>Sometimes vectorised code is easy to write and easy to read. I think the example above is pretty simple, for instance. It‚Äôs not always so easy though!</p>
<p>When you go out into the wider world of R programming you‚Äôll probably encounter a lot of examples of people talking about how to vectorise your code to produce better performance. My advice for novices is not to worry about that right now. Loops are perfectly fine, and it‚Äôs often more intuitive to write code using loops than using vectors. Eventually you‚Äôll probably want to think about these topics but it‚Äôs something that you can leave for a later date!</p>
</div>
<div id="exercises-3" class="section level3">
<h3><span class="header-section-number">B.2.8</span> Exercises</h3>
<p>To start with, here are some exercises with <code>for</code> loops and turtles: [WE‚ÄôRE DROPPING TURTLES]</p>
<ul>
<li>Use <strong>TurtleGraphics</strong> to draw a square rather than a hexagon</li>
<li>Use <strong>TurtleGraphics</strong> to draw a triangle.</li>
<li>Is there a way in which you can get R to automatically work out the <code>angle</code> rather than you having to manually work it out?</li>
</ul>
<p>As an exercise in using a <code>while</code> loop, consider this vector:</p>
<pre class="sourceCode r"><code class="sourceCode r">telegram &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;All&quot;</span>,<span class="st">&quot;is&quot;</span>,<span class="st">&quot;well&quot;</span>,<span class="st">&quot;here&quot;</span>,<span class="st">&quot;STOP&quot;</span>,<span class="st">&quot;This&quot;</span>,<span class="st">&quot;is&quot;</span>,<span class="st">&quot;fine&quot;</span>)</code></pre>
<ul>
<li>Write a <code>while</code> loop that prints words from <code>telegram</code> until it reaches <code>STOP</code>. When it encounters the word <code>STOP</code>, end the loop. So what you want is output that looks like this.</li>
</ul>
<pre><code>## [1] &quot;All&quot;
## [1] &quot;is&quot;
## [1] &quot;well&quot;
## [1] &quot;here&quot;
## [1] &quot;STOP&quot;</code></pre>
</div>
</div>
<div id="functions-1" class="section level2">
<h2><span class="header-section-number">B.3</span> Functions</h2>
<p>In this section I want to talk about functions again. We‚Äôve been using functions from the beginning, but you‚Äôve learned a lot about R since then, so we can talk about them in more detail. In particular, I want to show you how to create your own. To stick with the same basic framework that I used to describe loops and conditionals, here‚Äôs the syntax that you use to create a function:</p>
<pre><code>FNAME &lt;- function( ARG1, ARG2, ETC ) {
  STATEMENT1
  STATEMENT2
  ETC
  return( VALUE )
}</code></pre>
<p>What this does is create a function with the name <code>fname</code>, which has arguments <code>arg1</code>, <code>arg2</code> and so forth. Whenever the function is called, R executes the statements in the curly braces, and then outputs the contents of value to the user. Note, however, that R does not execute the function commands inside the workspace. Instead, what it does is create a temporary local environment: all the internal statements in the body of the function are executed there, so they remain invisible to the user. Only the final results in the <code>value</code> are returned to the workspace.</p>
<div id="a-boring-example" class="section level3">
<h3><span class="header-section-number">B.3.1</span> A boring example</h3>
<p>To give a simple example of this, let‚Äôs create a function called <code>quadruple</code> which multiplies its inputs by four.</p>
<pre class="sourceCode r"><code class="sourceCode r">quadruple &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  y &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="dv">4</span>
  <span class="kw">return</span>(y)
}</code></pre>
<p>When we run this command, nothing happens apart from the fact that a new object appears in the workspace corresponding to the <code>quadruple</code> function. Not surprisingly, if we ask R to tell us what kind of object it is, it tells us that it is a function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(quadruple)</code></pre>
<pre><code>## [1] &quot;function&quot;</code></pre>
<p>And now that we‚Äôve created the <code>quadruple()</code> function, we can call it just like any other function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadruple</span>(<span class="dv">10</span>)</code></pre>
<pre><code>## [1] 40</code></pre>
<p>An important thing to recognise here is that the two internal variables that the <code>quadruple</code> function makes use of, <code>x</code> and <code>y</code>, stay internal. At no point do either of these variables get created in the workspace.</p>
</div>
<div id="default-arguments" class="section level3">
<h3><span class="header-section-number">B.3.2</span> Default arguments</h3>
<p>Okay, now that we are starting to get a sense for how functions are constructed, let‚Äôs have a look at a slightly more complex example. Consider this function:</p>
<pre class="sourceCode r"><code class="sourceCode r">pow &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">y =</span> <span class="dv">1</span>) { 
  out &lt;-<span class="st"> </span>x <span class="op">^</span><span class="st"> </span>y  <span class="co"># raise x to the power y </span>
  <span class="kw">return</span>(out)
}</code></pre>
<p>The <code>pow</code> function takes two arguments <code>x</code> and <code>y</code>, and computes the value of <span class="math inline">\(x^y\)</span>. For instance, this command</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pow</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## [1] 16</code></pre>
<p>computes 4 squared. The interesting thing about this function isn‚Äôt what it does, since R already has has perfectly good mechanisms for calculating powers. Rather, notice that when I defined the function, I specified <code>y=1</code> when listing the arguments? That‚Äôs the default value for <code>y</code>. So if we enter a command without specifying a value for <code>y</code>, then the function assumes that we want <code>y=1</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pow</span>(<span class="dt">x =</span> <span class="dv">3</span>)</code></pre>
<pre><code>## [1] 3</code></pre>
<p>However, since I didn‚Äôt specify any default value for <code>x</code> when I defined the <code>pow</code> function, the user must input a value for <code>x</code> or else R will spit out an error message.</p>
</div>
<div id="unspecified-arguments" class="section level3">
<h3><span class="header-section-number">B.3.3</span> Unspecified arguments</h3>
<p>The other thing I should point out while I‚Äôm on this topic is the use of the <code>...</code> argument. The <code>...</code> argument is a special construct in R which is only used within functions. It is used as a way of matching against multiple user inputs: in other words, <code>...</code> is used as a mechanism to allow the user to enter as many inputs as they like. I won‚Äôt talk at all about the low-level details of how this works at all, but I will show you a simple example of a function that makes use of it. Consider the following:</p>
<pre class="sourceCode r"><code class="sourceCode r">doubleMax &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
  max.val &lt;-<span class="st"> </span><span class="kw">max</span>(...)  <span class="co"># find the largest value in ...</span>
  out &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>max.val   <span class="co"># double it</span>
  <span class="kw">return</span>(out)
}</code></pre>
<p>The <code>doubleMax</code> function doesn‚Äôt do anything with the user input(s) other than pass them directly to the <code>max</code> function. You can type in as many inputs as you like: the <code>doubleMax</code> function identifies the largest value in the inputs, by passing all the user inputs to the <code>max</code> function, and then doubles it. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">doubleMax</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</code></pre>
<pre><code>## [1] 10</code></pre>
</div>
<div id="more-on-functions" class="section level3">
<h3><span class="header-section-number">B.3.4</span> More on functions?</h3>
<p>There‚Äôs a lot of other details to functions that I‚Äôve hidden in my description in this chapter. Experienced programmers will wonder exactly how the <a href="https://bookdown.org/rdpeng/rprogdatascience/scoping-rules-of-r.html">scoping rules</a> work in R, or want to know how to use a function to create variables in other environments, or if function objects can be assigned as elements of a list and probably hundreds of other things besides. However, I don‚Äôt want to have this discussion get too cluttered with details, so I think it‚Äôs best ‚Äì at least for the purposes of the current book ‚Äì to stop here.</p>
</div>
</div>
<div id="rescorla-wagner-model" class="section level2">
<h2><span class="header-section-number">B.4</span> Rescorla-Wagner model</h2>
<p>At this point you have all the tools you need to write a fully functional R program. To illustrate this, let‚Äôs write a program that implements the <a href="http://www.scholarpedia.org/article/Rescorla-Wagner_model">Rescorla-Wagner model</a> of associative learning, and apply it to a few simple experimental designs.</p>
<div id="the-model-itself" class="section level3">
<h3><span class="header-section-number">B.4.1</span> The model itself</h3>
<p>The Rescorla-Wagner model provides a learning rule that describes how associative strength changes during Pavlovian conditioning. Suppose we take an initially neutral stimulus (e.g., a tone), and pair it with an outcome that has inherent value to the organism (e.g., food, shock). Over time the organism learns to associate the tone with the shock and will respond to the tone in much the same way that it does to the shock. In this example the shock is referred to as the <em>unconditioned stimulus</em> (US) and the tone is the <em>conditioned stimulus</em> (CS).</p>
<p>Suppose we present a compound stimulus AB, which consists of two things, a tone (A) and a light (B). This compound is presented together with a shock. In associative learning studies, this kind of trial is denoted AB+ to indicate that the outcome (US) was present at the same time as the two stimuli that comprise the CS. According to the Rescorla-Wagner model, the rule for updating the associative strengths <span class="math inline">\(v_A\)</span> and <span class="math inline">\(v_B\)</span> between the originally neutral stimuli and the shock is given by:</p>
<p><span class="math display">\[
\begin{array}{rcl}
v_A &amp;\leftarrow&amp; v_A + \alpha_A \beta_U (\lambda_U - v_{AB}) \\
v_B &amp;\leftarrow&amp; v_B + \alpha_B \beta_U (\lambda_U - v_{AB}) \\
\end{array}
\]</span>
where the associative value <span class="math inline">\(v_{AB}\)</span> of the compound stimulus AB is just the sum of the values of the two items individually. This is expressed as:</p>
<p><span class="math display">\[
v_{AB} = v_A + v_B
\]</span></p>
<p>To understand this rule, note that:</p>
<ul>
<li><span class="math inline">\(\lambda_U\)</span> is a variable that represents the ‚Äúreward value‚Äù (or ‚Äúpunishment value‚Äù) of the US itself, and as such represents the maximum possible association strength for the CS.</li>
<li><span class="math inline">\(\beta_U\)</span> is a learning rate linked to the US (e.g.¬†how quickly do I learn about shocks?)</li>
<li><span class="math inline">\(\alpha_A\)</span> is a learning rate linked to the CS (e.g, how quickly do I learn about tones?)</li>
<li><span class="math inline">\(\alpha_B\)</span> is also a learning rate linked to the CS (e.g, how quickly do I learn about lights?)</li>
</ul>
<p>So this rule is telling us that we should adjust the values of <span class="math inline">\(v_A\)</span> and <span class="math inline">\(v_B\)</span> in a fashion that partly depends on the learning rate parameters (<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>), and partly depends on the <em>prediction error</em> (<span class="math inline">\(\lambda - v_{AB}\)</span>) corresponding to the <em>difference</em> between the actual outcome value <span class="math inline">\(\lambda\)</span> and the value of the compound <span class="math inline">\(v_{AB}\)</span>.</p>
<p>The Rescorla-Wagner successfully predicts many phenomena in associative learning, though it does have a number of shortcomings. However, despite its simplicity it can be a little difficult at times to get a good intuitive feel for what the model predicts. To remedy this, lets implement this learning rule as an R function, and then apply it to a few experimental designs.</p>
</div>
<div id="r-implementation" class="section level3">
<h3><span class="header-section-number">B.4.2</span> R implementation</h3>
<p>To work out how to write a function that implements the Rescorla-Wagner update rule, the first thing we need to ask ourselves is <em>what situations do we want to describe?</em> Do we want to be able to handle stimuli consisting of only a single feature (A), compounds with two features (AB), or compounds that might have any number of features? Do we want it to handle any possible values for the parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\lambda\)</span> or just some? For the current exercise, I‚Äôll try to write something fairly general-purpose!</p>
</div>
<div id="the-skeleton" class="section level3">
<h3><span class="header-section-number">B.4.3</span> The skeleton</h3>
<p>To start with, I‚Äôll create a skeleton for the function that looks like this:</p>
<pre class="sourceCode r"><code class="sourceCode r">update_RW &lt;-<span class="st"> </span><span class="cf">function</span>(value, alpha, beta, lambda) {
}</code></pre>
<p>My thinking is that <code>value</code> is going to be a vector that specifies the associative strength of association between the US and each element of the CS: that is, it will contain the values <span class="math inline">\(v_A\)</span>, <span class="math inline">\(v_B\)</span>, etc. Similarly, the <code>alpha</code> argument will be a vector that specifies the various salience parameters (<span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, etc) associated with the CS. I‚Äôm going to assume that there is only ever a single US presented, so we‚Äôll assume that the learning rate <span class="math inline">\(\beta\)</span> and the maximum associability <span class="math inline">\(\lambda\)</span> associated with the US are just numbers.</p>
</div>
<div id="make-a-plan" class="section level3">
<h3><span class="header-section-number">B.4.4</span> Make a plan</h3>
<p>So now how do I fill out the contents of this function? The first thing I usually do is add some comments to scaffold the rest of my code. Basically I‚Äôm making a plan:</p>
<pre class="sourceCode r"><code class="sourceCode r">update_RW &lt;-<span class="st"> </span><span class="cf">function</span>(value, alpha, beta, lambda) {
  <span class="co"># compute the value of the compound stimulus</span>
  <span class="co"># compute the prediction error</span>
  <span class="co"># compute the change in strength</span>
  <span class="co"># update the association value</span>
  <span class="co"># return the new value</span>
}</code></pre>
</div>
<div id="fill-in-the-pieces" class="section level3">
<h3><span class="header-section-number">B.4.5</span> Fill in the pieces</h3>
<p>Since the stimulus might be a compound (e.g.¬†AB or ABC), the first thing we need to do is calculate the value (<span class="math inline">\(V_{AB}\)</span>) of the compound stimulus. In the Rescorla-Wagner model, the associative strength for the compound is just the sum of the individual strengths, so I can use the <code>sum</code> function to add up all the elements of the <code>value</code> argument:</p>
<pre class="sourceCode r"><code class="sourceCode r">update_RW &lt;-<span class="st"> </span><span class="cf">function</span>(value, alpha, beta, lambda) {
  
  <span class="co"># compute the value of the compound stimulus</span>
  value_compound &lt;-<span class="st"> </span><span class="kw">sum</span>(value) 
  
  <span class="co"># compute the prediction error</span>
  <span class="co"># compute the change in strength</span>
  <span class="co"># update the association value</span>
  <span class="co"># return the new value</span>
}</code></pre>
<p>The <code>value_compound</code> vector plays the same role in my R function that <span class="math inline">\(V_{AB}\)</span> plays in the equations for the Rescorla-Wagner model. However, if we look at the Rescorla-Wagner model, it‚Äôs clear that the quantity that actually drives learning is the <em>prediction error</em>, <span class="math inline">\(\lambda_U - V_{AB}\)</span>, namely the difference between the maximum association strength that the US supports and the current association strength for the compound. Well that‚Äôs easy‚Ä¶ it‚Äôs just subtraction:</p>
<pre class="sourceCode r"><code class="sourceCode r">update_RW &lt;-<span class="st"> </span><span class="cf">function</span>(value, alpha, beta, lambda) {
  
  <span class="co"># compute the value of the compound stimulus</span>
  value_compound &lt;-<span class="st"> </span><span class="kw">sum</span>(value) 
  
  <span class="co"># compute the prediction error</span>
  prediction_error &lt;-<span class="st"> </span>lambda <span class="op">-</span><span class="st"> </span>value_compound
  
  <span class="co"># compute the change in strength</span>
  <span class="co"># update the association value</span>
  <span class="co"># return the new value</span>
}</code></pre>
<p>Now we have to multiply everything by <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, in order to work out how much learning has occurred. In the Rescorla-Wagner model this is often denoted <span class="math inline">\(\Delta v\)</span>. That is:</p>
<p><span class="math display">\[
\begin{array}{rcl}
\Delta v_A &amp;=&amp; \alpha_A \beta_U (\lambda_U - v_{AB}) \\
\Delta v_B &amp;=&amp; \alpha_B \beta_U (\lambda_U - v_{AB}) \\
\end{array}
\]</span></p>
<p>Within our R function, that‚Äôs really simple because that‚Äôs just multiplication. So let‚Äôs do that, and while we‚Äôre at it we‚Äôll update the <code>value</code> (that‚Äôs just addition) and return the new association value‚Ä¶</p>
<pre class="sourceCode r"><code class="sourceCode r">update_RW &lt;-<span class="st"> </span><span class="cf">function</span>(value, alpha, beta, lambda) {
  
  <span class="co"># compute the value of the compound stimulus</span>
  value_compound &lt;-<span class="st"> </span><span class="kw">sum</span>(value) 
  
  <span class="co"># compute the prediction error</span>
  prediction_error &lt;-<span class="st"> </span>lambda <span class="op">-</span><span class="st"> </span>value_compound
  
  <span class="co"># compute the change in strength</span>
  value_change &lt;-<span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>prediction_error 
  
  <span class="co"># update the association value</span>
  value &lt;-<span class="st"> </span>value <span class="op">+</span><span class="st"> </span>value_change
  
  <span class="co"># return the new value</span>
  <span class="kw">return</span>(value)
}</code></pre>
</div>
<div id="tidying" class="section level3">
<h3><span class="header-section-number">B.4.6</span> Tidying</h3>
<p>Depending on your personal preferences, you might want to reorganise to make this a little shorter. You could do this by shortening the comments and moving them to the side. You might also want to set some sensible default values, as I have done here:</p>
<pre class="sourceCode r"><code class="sourceCode r">update_RW &lt;-<span class="st"> </span><span class="cf">function</span>(value, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">beta=</span>.<span class="dv">3</span>, <span class="dt">lambda=</span><span class="dv">1</span>) {
  value_compound &lt;-<span class="st"> </span><span class="kw">sum</span>(value)                    <span class="co"># value of the compound </span>
  prediction_error &lt;-<span class="st"> </span>lambda <span class="op">-</span><span class="st"> </span>value_compound     <span class="co"># prediction error</span>
  value_change &lt;-<span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>prediction_error <span class="co"># change in strength</span>
  value &lt;-<span class="st"> </span>value <span class="op">+</span><span class="st"> </span>value_change                   <span class="co"># update value</span>
  <span class="kw">return</span>(value)
}</code></pre>
<p>All done! Yay! üéà</p>
</div>
<div id="model-predictions" class="section level3">
<h3><span class="header-section-number">B.4.7</span> Model predictions</h3>
<p>Okay, now that we have a function <code>update_RW</code> that implements the Rescorla-Wagner learning rule, let‚Äôs use it to make predictions about three learning phenomena: <em>conditioning</em>, <em>extinction</em> and <em>blocking</em>.</p>
</div>
<div id="conditioning" class="section level3">
<h3><span class="header-section-number">B.4.8</span> Conditioning</h3>
<p>For the first ‚Äúexperiment‚Äù to simulate, we‚Äôll pair a simple CS (i.e.¬†not compound) with a US for 20 trials, and examine how the association strength changes over time. So get started, we‚Äôll specify the number of trials</p>
<pre class="sourceCode r"><code class="sourceCode r">n_trials &lt;-<span class="st"> </span><span class="dv">20</span>  </code></pre>
<p>and we‚Äôll create a numeric <code>strength</code> vector that we will use to store the association strengths. The way we‚Äôll do that is like this:</p>
<pre class="sourceCode r"><code class="sourceCode r">strength &lt;-<span class="st"> </span><span class="kw">numeric</span>(n_trials)
strength</code></pre>
<pre><code>##  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<p>As you can see, the <code>numeric</code> function has created a vector of zeros for us. When trial 1 begins association strength is in fact zero, so that much is correct at least, but of course we‚Äôll need to use the <code>update_RW</code> function to fill in the other values correctly. To do that, all we have to do is let the experiment run! We set up a loop in which we ‚Äúpresent‚Äù the CS-US pairing and update the association strength at the end of each trial:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(trial <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n_trials) {
  strength[trial] &lt;-<span class="st"> </span><span class="kw">update_RW</span>( strength[trial<span class="dv">-1</span>] )
}</code></pre>
<p>That‚Äôs it! Now we print out the association strength:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(strength)</code></pre>
<pre><code>##  [1] 0.0000000 0.0900000 0.1719000 0.2464290 0.3142504 0.3759679 0.4321307
##  [8] 0.4832390 0.5297475 0.5720702 0.6105839 0.6456313 0.6775245 0.7065473
## [15] 0.7329580 0.7569918 0.7788626 0.7987649 0.8168761 0.8333572</code></pre>
<p>You can see in the output that with repeated stimulus presentations, the strength of the association rises quickly. It‚Äôs a little easier to see what‚Äôs going on if we draw a picture though:</p>
<p><img src="rbook2_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>I‚Äôve hidden the R command that produces the plot, because we haven‚Äôt covered data visualisation yet. However, if you are interested in a sneak peek, the source code for all the analyses in this section are <a href="./scripts/rescorla_wagner.R">here</a>.</p>
</div>
<div id="extinction" class="section level3">
<h3><span class="header-section-number">B.4.9</span> Extinction</h3>
<p>For the second example, let‚Äôs consider the extinction of a learned association. What we‚Äôll do this time is start out doing the same thing as last time. For the first 25 trials we‚Äôll present a CS-US trial that pairs a tone with a shock (or whatever) and over that time the association for the CS will rise to match the reward ‚Äúvalue‚Äù (<span class="math inline">\(\lambda = .3\)</span>) linked to the US. Then for the next 25 trials we will present the CS alone with no US present. We‚Äôll capture this by setting <span class="math inline">\(\lambda = 0\)</span> to reflect the fact that the ‚Äúvalue‚Äù to be predicted is now zero (i.e.¬†no shock). For simplicity, we‚Äôll leave the learning rate <span class="math inline">\(\beta\)</span> the same for shock and no-shock.</p>
<p>Okay here goes. First, let‚Äôs set up our variables:</p>
<pre class="sourceCode r"><code class="sourceCode r">n_trials &lt;-<span class="st"> </span><span class="dv">50</span>                
strength &lt;-<span class="st"> </span><span class="kw">numeric</span>(n_trials) 
lambda &lt;-<span class="st"> </span><span class="fl">.3</span> <span class="co"># initial reward value </span></code></pre>
<p>Now we have to set up our loop, same as before. This time around we need to include an <code>if</code> statement in the loop, to check whether we have moved from the learning phase (trials 1 to 25) to the extinction phase (trials 26 to 50), and adjust the value of <span class="math inline">\(\lambda\)</span> accordingly.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(trial <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n_trials) {
  
  <span class="co"># remove the shock after trial 25</span>
  <span class="cf">if</span>(trial <span class="op">&gt;</span><span class="st"> </span><span class="dv">25</span>) {
    lambda &lt;-<span class="st"> </span><span class="dv">0</span>
  }
  
  <span class="co"># update associative strength on each trial</span>
  strength[trial] &lt;-<span class="st"> </span><span class="kw">update_RW</span>(
    <span class="dt">value =</span> strength[trial<span class="dv">-1</span>],
    <span class="dt">lambda =</span> lambda
  )
}</code></pre>
<p>What we expect to see in this situation is that after trial 25 when the shock is removed, the association strength starts to weaken because the learner is now associating the CS with no-shock (i.e. <span class="math inline">\(\lambda\)</span> has dropped to zero and so the association <span class="math inline">\(v\)</span> is slowly reverting to that value). Here‚Äôs the raw numbers:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(strength)</code></pre>
<pre><code>##  [1] 0.00000000 0.02700000 0.05157000 0.07392870 0.09427512 0.11279036
##  [7] 0.12963922 0.14497169 0.15892424 0.17162106 0.18317516 0.19368940
## [13] 0.20325735 0.21196419 0.21988741 0.22709755 0.23365877 0.23962948
## [19] 0.24506283 0.25000717 0.25450653 0.25860094 0.26232685 0.26571744
## [25] 0.26880287 0.24461061 0.22259565 0.20256205 0.18433146 0.16774163
## [31] 0.15264488 0.13890684 0.12640523 0.11502876 0.10467617 0.09525531
## [37] 0.08668234 0.07888093 0.07178164 0.06532129 0.05944238 0.05409256
## [43] 0.04922423 0.04479405 0.04076259 0.03709395 0.03375550 0.03071750
## [49] 0.02795293 0.02543716</code></pre>
<p>Here they are as a pretty picture:</p>
<p><img src="rbook2_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>That looks right to me! Extinction is initially effective at removing the association, but it‚Äôs effectiveness declines over time, so that by the end of the task there‚Äôs still some association left.</p>
</div>
<div id="blocking" class="section level3">
<h3><span class="header-section-number">B.4.10</span> Blocking</h3>
<p>For the final example, consider a blocking paradigm. In this design we might initially pair a tone with a shock (A+ trials) for a number of trials until an association is learned. Then we present a compound stimulus AB (tone plus light) together with a shock (AB+). During the first phase, the learner quickly acquires a strong association between A and the shock, but then during the second phase they don‚Äôt learn very much about B, because A already predicts the shock.<a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a></p>
<p>Because we are presenting a compound stimulus, the values that we pass to the <code>update_RW</code> function can be vectors. But that‚Äôs okay, we designed our function to be able to handle that. So let‚Äôs start by setting up our modelling exercise:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># total number of trials across </span>
<span class="co"># both phases of the task</span>
n_trials &lt;-<span class="st"> </span><span class="dv">50</span>

<span class="co"># vectors of zeros</span>
strength_A &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n_trials)
strength_B &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n_trials)</code></pre>
<p>There are two strength vectors here, one for the tone (A) and one for the light (B). Of course, during the first phase of the task the light isn‚Äôt actually present, which we can capture by setting the relevant learning rate (or salience) parameter <span class="math inline">\(\alpha\)</span> to 0:</p>
<pre class="sourceCode r"><code class="sourceCode r">alpha &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="dv">0</span>)</code></pre>
<p>This means that at the start of the task, the model will learn about the tone but not the light. After trial 15, however, both stimuli will be present. For simplicity I‚Äôll assume they‚Äôre equally salient, so after trial 15 the <span class="math inline">\(\alpha\)</span> value becomes .3 for both stimuli.</p>
<p>As before we construct a loop over the trials:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(trial <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n_trials) {
  
  <span class="co"># after trial 15, both stimuli are present</span>
  <span class="cf">if</span>(trial <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>) alpha &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.3</span>)
  
  <span class="co"># vector of current associative strengths</span>
  v_old &lt;-<span class="st"> </span><span class="kw">c</span>(strength_A[trial<span class="dv">-1</span>], strength_B[trial<span class="dv">-1</span>])
  
  <span class="co"># vector of new associative strengths</span>
  v_new &lt;-<span class="st"> </span><span class="kw">update_RW</span>(
    <span class="dt">value =</span> v_old,
    <span class="dt">alpha =</span> alpha
   )
  
  <span class="co"># record the new strengths</span>
  strength_A[trial] &lt;-<span class="st"> </span>v_new[<span class="dv">1</span>]
  strength_B[trial] &lt;-<span class="st"> </span>v_new[<span class="dv">2</span>]
}</code></pre>
<p>It‚Äôs a little more complex this time because we have read off two strength values and pass them to the <code>update_RW</code> function.<a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a> Hopefully it is clear what this code is doing.</p>
<p>As with the previous two examples we could print out <code>strength_A</code> and <code>strength_B</code>, but realistically no-one likes looking at long lists of numbers so let‚Äôs just draw the picture. In the plot below, the blue line shows the associative strength to A and the red line shows the associative strength to B:</p>
<p><img src="rbook2_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>That‚Äôs the blocking effect, right there üòÄ. The model learns a strong association between the tone and the shock (blue) but the association it learns between the light and the shock (red) is much weaker.</p>
</div>
<div id="done" class="section level3">
<h3><span class="header-section-number">B.4.11</span> Done!</h3>
<p>If you‚Äôve been following along yourself you are now officially a computational modeller. Nice work!</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="31">
<li id="fn31"><p>There are other ways of making conditional statements in R. In particular, the <code>ifelse</code> function and the <code>switch</code> functions can be very useful in different contexts.<a href="programming.html#fnref31" class="footnote-back">‚Ü©</a></p></li>
<li id="fn32"><p>In a real blocking study there would be various control conditions but I‚Äôm not going to bother modelling those here. I just want to show how our code works for the important one!<a href="programming.html#fnref32" class="footnote-back">‚Ü©</a></p></li>
<li id="fn33"><p>In fact, we could make this code a lot simpler if we‚Äôd recorded the strengths as a <strong>matrix</strong> rather than two vectors, but since I haven‚Äôt introduced matrices yet I‚Äôve left it in this slightly more clunky form with vectors<a href="programming.html#fnref33" class="footnote-back">‚Ü©</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["rbook2.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
